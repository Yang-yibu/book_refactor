
## 重构，第一个示例

差劲的系统是很难修改的，因为很难找到修改点，难以了解做出的修改与现有代码如何协作实现我想要的行为。如果很难找到修改点，就很可能犯错，从而引入 Bug。

### 起点

数据文件：`/src/data`
示例的程序： `/src/part01/index.js`

程序的问题：
- 结构不清晰，在此基础上增加新需求会越来越复杂。例如
  - 需求 1：客户需要以其他格式输出详单；（在其他场景中，如支持跨平台）
  - 需求 2：表演类型增加或者不确定，导致剧场的计费方式和积分计算方式变化
  - 不久的将来其他的需求

需求的变化使重构变得必要。

重构的时机：如果有人需要理解他的工作原理，并且觉的理解起来很费劲，就需要改进一下代码

小步修改，修改完成后运行测试

### 分解 statement 函数

`/src/part01/index1.js`

提炼函数 Extract Function
- 查看代码块中那些变量会离开原来的作用域
- 那些变量被函数使用后不会被修改，可以当成参数传入
- 那些变量被修改
  - 可以直接从函数中返回
  - 可以初始化放到提炼后的函数里
- 提炼完成后，修改变量名。提升其表达能力（可读性）
- 观察函数的参数来源，移除不必要的局部临时变量
